@page "/product"
@using DxBlazorWeb.Services.Interface
@using DevExpress.Blazor
@using DxBlazorWeb.Components.Modal
@using DxBlazorWeb.Model
@inject IAppService AppService
@inject IJSRuntime JSRuntime
@rendermode InteractiveServer

<PageTitle>Sản phẩm</PageTitle>
<PageHeader Title="Quản lý sản phẩm" />
<style>
    .dxbl-tabs.dxbl-tabs-top > .dxbl-tabs-tablist {
        margin-bottom: 12px;
    }
</style>
<div class="main-content">
    <div class="d-flex flex-column" style="width:100%">
        <DxButton Text="Thêm sản phẩm" IconCssClass="fa fa-plus"
                  IconPosition="ButtonIconPosition.BeforeText"
                  Click="OpenCreateModal" CssClass="mb-2" />
    </div>
</div>

<!-- Gọi modal -->
<ProductModal @bind-Visible="isProductModalVisible"
              IsEdit="isEdit" />

@code {
    // state của modal
    private bool isProductModalVisible = false;
    private bool isEdit = false;

    private void OpenCreateModal()
    {
        isEdit = false;
        isProductModalVisible = true;
    }

    // Nhận kết quả lưu từ modal
    private async Task OnProductSaved(SanPham saved)
    {
        isProductModalVisible = false;
        // TODO: refresh grid/danh sách sản phẩm nếu có
        await JSRuntime.InvokeVoidAsync("console.log", $"Saved product: {saved.MA_HANG}");
    }
}
